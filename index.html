<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malla Curricular - Licenciatura en Turismo en L√≠nea</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Variables CSS para colores */
        :root {
            /* Fondo de la p√°gina */
            --bg-neutral-light: #F7F7F7;

            /* Paletas de Unidades */
            --unit-pre-bg: #E1F3FB;
            --unit-basica-bg: #E6F9E8;
            --unit-profesional-bg: #FFFBEB;
            --unit-titulacion-bg: #FFEAEA;

            /* Colores de Semestres (fondo de tarjetas de materia) */
            --sem-pre-card-1: #E0F7FA; --sem-pre-card-2: #B2EBF2; --sem-pre-card-3: #80DEEA; --sem-pre-card-4: #4DD0E1; --sem-pre-card-5: #26C6DA; --sem-pre-card-6: #00BCD4;
            --sem-pre-title: #008BA3;

            --sem-1-card-1: #E8F5E9; --sem-1-card-2: #C8E6C9; --sem-1-card-3: #A5D6A7; --sem-1-card-4: #81C784; --sem-1-card-5: #66BB6A; --sem-1-card-6: #43A047;
            --sem-1-title: #1B5E20;

            --sem-2-card-1: #FFF3E0; --sem-2-card-2: #FFE0B2; --sem-2-card-3: #FFCC80; --sem-2-card-4: #FFB74D; --sem-2-card-5: #FFA726; --sem-2-card-6: #FF9800;
            --sem-2-title: #EF6C00;

            --sem-3-card-1: #F3E5F5; --sem-3-card-2: #E1BEE7; --sem-3-card-3: #CE93D8; --sem-3-card-4: #BA68C8; --sem-3-card-5: #AB47BC; --sem-3-card-6: #9C27B0;
            --sem-3-title: #6A1B9A;

            --sem-4-card-1: #FCE4EC; --sem-4-card-2: #F8BBD0; --sem-4-card-3: #F48FB1; --sem-4-card-4: #F06292; --sem-4-card-5: #EC407A; --sem-4-card-6: #E91E63;
            --sem-4-title: #AD1457;

            --sem-5-card-1: #FFFDE7; --sem-5-card-2: #FFF9C4; --sem-5-card-3: #FFF59D; --sem-5-card-4: #FFF176; --sem-5-card-5: #FFEE58; --sem-5-card-6: #FFEB3B;
            --sem-5-title: #FBC02D;

            --sem-6-card-1: #FFEBEE; --sem-6-card-2: #FFCDD2; --sem-6-card-3: #EF9A9A; --sem-6-card-4: #E57373; --sem-6-card-5: #EF5350; --sem-6-card-6: #F44336;
            --sem-6-title: #C62828;

            --sem-7-card-1: #E8F5E9; --sem-7-card-2: #C8E6C9; --sem-7-card-3: #A5D6A7; --sem-7-card-4: #81C784; --sem-7-card-5: #66BB6A; --sem-7-card-6: #388E3C;
            --sem-7-title: #1B5E20;

            --sem-8-card-1: #E3F2FD; --sem-8-card-2: #BBDEFB; --sem-8-card-3: #90CAF9; --sem-8-card-4: #64B5F6; --sem-8-card-5: #42A5F5; --sem-8-card-6: #1976D2;
            --sem-8-title: #0D47A1;

            --sem-9-card-1: #FAFAFA; --sem-9-card-2: #F5F5F5; --sem-9-card-3: #EEEEEE; --sem-9-card-4: #E0E0E0; --sem-9-card-5: #BDBDBD; --sem-9-card-6: #757575;
            --sem-9-title: #424242;

            /* Colores de M√≥dulos */
            --module-bg-neutral: #F7F7F7;
            --module-ing-card-1: #E0F7FA; --module-ing-card-2: #B2EBF2; --module-ing-card-3: #80DEEA; --module-ing-card-4: #4DD0E1; --module-ing-card-5: #26C6DA; --module-ing-card-6: #00BCD4; --module-ing-card-7: #0097A7;
            --module-ing-title: #006064;

            --module-comp-card-1: #F3E5F5; --module-comp-card-2: #E1BEE7; --module-comp-card-3: #CE93D8;
            --module-comp-title: #6A1B9A;
        }

        /* Estilos generales */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-neutral-light);
            color: #333;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 1400px; /* Ancho m√°ximo para el contenido */
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            padding: 30px;
            box-sizing: border-box;
            margin-bottom: 20px;
        }

        h1, h2, h3, h4 {
            font-weight: 600;
            color: #222;
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            font-size: 2.5em;
            color: #0056b3; /* Un azul m√°s oscuro para el t√≠tulo principal */
        }

        h2 {
            font-size: 1.8em;
            margin-top: 30px;
        }

        h3 {
            font-size: 1.4em;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        /* Secci√≥n de estad√≠sticas */
        .stats-section {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
            padding: 20px;
            background-color: #f0f8ff; /* Un fondo suave para las estad√≠sticas */
            border-radius: 10px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.03);
        }

        .stat-card {
            background-color: #e0f0ff;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            min-width: 180px;
            flex: 1;
            max-width: 250px;
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-card h4 {
            margin: 0 0 8px 0;
            font-size: 1.1em;
            color: #004085;
        }

        .stat-card p {
            margin: 0;
            font-size: 1.6em;
            font-weight: 700;
            color: #0056b3;
        }

        /* Unidades */
        .units-container, .modules-container {
            display: flex;
            flex-direction: column; /* Cambiado a columna para apilar */
            justify-content: center;
            gap: 30px; /* Espacio entre unidades/m√≥dulos */
            margin-top: 40px;
        }

        .unit {
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
            flex: 1;
            min-width: 300px;
            max-width: 100%; /* Permite que la unidad ocupe todo el ancho en pantallas peque√±as */
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        .unit-preuniversitaria { background-color: var(--unit-pre-bg); }
        .unit-basica { background-color: var(--unit-basica-bg); }
        .unit-profesional { background-color: var(--unit-profesional-bg); }
        .unit-titulacion { background-color: var(--unit-titulacion-bg); }

        .unit h3 {
            font-size: 1.6em;
            margin-top: 0;
            margin-bottom: 25px;
            color: #0056b3; /* Color oscuro para el t√≠tulo de la unidad */
        }

        /* Semestres */
        .semesters-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .semester {
            background-color: #fff; /* Fondo blanco para el semestre dentro de la unidad */
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
            flex: 1 1 calc(33.333% - 20px); /* 3 columnas en desktop, ajusta para mobile */
            box-sizing: border-box;
            min-width: 280px; /* Ancho m√≠nimo para cada semestre */
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.2s ease;
        }

        .semester:hover {
            transform: translateY(-5px);
        }

        .semester-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 15px;
            padding: 8px 15px;
            border-radius: 8px;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            width: 100%;
            box-sizing: border-box;
        }

        /* Colores de t√≠tulos de semestre */
        .sem-pre .semester-title { background-color: var(--sem-pre-title); }
        .sem-1 .semester-title { background-color: var(--sem-1-title); }
        .sem-2 .semester-title { background-color: var(--sem-2-title); }
        .sem-3 .semester-title { background-color: var(--sem-3-title); }
        .sem-4 .semester-title { background-color: var(--sem-4-title); }
        .sem-5 .semester-title { background-color: var(--sem-5-title); }
        .sem-6 .semester-title { background-color: var(--sem-6-title); }
        .sem-7 .semester-title { background-color: var(--sem-7-title); }
        .sem-8 .semester-title { background-color: var(--sem-8-title); }
        .sem-9 .semester-title { background-color: var(--sem-9-title); }

        /* Materias */
        .subject-card {
            background-color: #f9f9f9;
            border-radius: 10px;
            padding: 12px 15px;
            margin-bottom: 10px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            box-sizing: border-box;
            position: relative; /* Para el tooltip */
        }

        .subject-card:last-child {
            margin-bottom: 0;
        }

        .subject-card.approved {
            background-color: #d4edda; /* Verde suave para aprobado */
            color: #155724;
            border: 1px solid #c3e6cb;
            box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1);
        }

        .subject-card.blocked {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: #f8d7da; /* Rojo suave para bloqueado */
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .subject-card span.icon {
            font-size: 1.2em;
            line-height: 1;
        }

        .subject-info {
            flex-grow: 1;
        }

        .subject-info strong {
            display: block;
            font-size: 0.95em;
            font-weight: 500;
        }

        .subject-info small {
            font-size: 0.8em;
            color: #666;
        }

        .subject-card.approved .subject-info small {
            color: #155724;
        }

        .subject-card.blocked .subject-info small {
            color: #721c24;
        }

        /* Tooltip */
        .tooltip {
            visibility: hidden;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px 12px;
            position: absolute;
            z-index: 1;
            bottom: 100%; /* Arriba de la tarjeta */
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 10px;
            opacity: 0;
            transition: opacity 0.3s;
            white-space: nowrap;
            font-size: 0.85em;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .subject-card.blocked:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }

        /* Colores de las tarjetas de materia por semestre */
        .sem-pre .subject-card:nth-child(1) { background-color: var(--sem-pre-card-1); }
        .sem-pre .subject-card:nth-child(2) { background-color: var(--sem-pre-card-2); }
        .sem-pre .subject-card:nth-child(3) { background-color: var(--sem-pre-card-3); }

        .sem-1 .subject-card:nth-child(1) { background-color: var(--sem-1-card-1); }
        .sem-1 .subject-card:nth-child(2) { background-color: var(--sem-1-card-2); }
        .sem-1 .subject-card:nth-child(3) { background-color: var(--sem-1-card-3); }
        .sem-1 .subject-card:nth-child(4) { background-color: var(--sem-1-card-4); }
        .sem-1 .subject-card:nth-child(5) { background-color: var(--sem-1-card-5); }
        .sem-1 .subject-card:nth-child(6) { background-color: var(--sem-1-card-6); }

        .sem-2 .subject-card:nth-child(1) { background-color: var(--sem-2-card-1); }
        .sem-2 .subject-card:nth-child(2) { background-color: var(--sem-2-card-2); }
        .sem-2 .subject-card:nth-child(3) { background-color: var(--sem-2-card-3); }
        .sem-2 .subject-card:nth-child(4) { background-color: var(--sem-2-card-4); }
        .sem-2 .subject-card:nth-child(5) { background-color: var(--sem-2-card-5); }
        .sem-2 .subject-card:nth-child(6) { background-color: var(--sem-2-card-6); }

        .sem-3 .subject-card:nth-child(1) { background-color: var(--sem-3-card-1); }
        .sem-3 .subject-card:nth-child(2) { background-color: var(--sem-3-card-2); }
        .sem-3 .subject-card:nth-child(3) { background-color: var(--sem-3-card-3); }
        .sem-3 .subject-card:nth-child(4) { background-color: var(--sem-3-card-4); }
        .sem-3 .subject-card:nth-child(5) { background-color: var(--sem-3-card-5); }
        .sem-3 .subject-card:nth-child(6) { background-color: var(--sem-3-card-6); }

        .sem-4 .subject-card:nth-child(1) { background-color: var(--sem-4-card-1); }
        .sem-4 .subject-card:nth-child(2) { background-color: var(--sem-4-card-2); }
        .sem-4 .subject-card:nth-child(3) { background-color: var(--sem-4-card-3); }
        .sem-4 .subject-card:nth-child(4) { background-color: var(--sem-4-card-4); }
        .sem-4 .subject-card:nth-child(5) { background-color: var(--sem-4-card-5); }
        .sem-4 .subject-card:nth-child(6) { background-color: var(--sem-4-card-6); }

        .sem-5 .subject-card:nth-child(1) { background-color: var(--sem-5-card-1); }
        .sem-5 .subject-card:nth-child(2) { background-color: var(--sem-5-card-2); }
        .sem-5 .subject-card:nth-child(3) { background-color: var(--sem-5-card-3); }
        .sem-5 .subject-card:nth-child(4) { background-color: var(--sem-5-card-4); }
        .sem-5 .subject-card:nth-child(5) { background-color: var(--sem-5-card-5); }
        .sem-5 .subject-card:nth-child(6) { background-color: var(--sem-5-card-6); }

        .sem-6 .subject-card:nth-child(1) { background-color: var(--sem-6-card-1); }
        .sem-6 .subject-card:nth-child(2) { background-color: var(--sem-6-card-2); }
        .sem-6 .subject-card:nth-child(3) { background-color: var(--sem-6-card-3); }
        .sem-6 .subject-card:nth-child(4) { background-color: var(--sem-6-card-4); }
        .sem-6 .subject-card:nth-child(5) { background-color: var(--sem-6-card-5); }
        .sem-6 .subject-card:nth-child(6) { background-color: var(--sem-6-card-6); }

        .sem-7 .subject-card:nth-child(1) { background-color: var(--sem-7-card-1); }
        .sem-7 .subject-card:nth-child(2) { background-color: var(--sem-7-card-2); }
        .sem-7 .subject-card:nth-child(3) { background-color: var(--sem-7-card-3); }
        .sem-7 .subject-card:nth-child(4) { background-color: var(--sem-7-card-4); }
        .sem-7 .subject-card:nth-child(5) { background-color: var(--sem-7-card-5); }
        .sem-7 .subject-card:nth-child(6) { background-color: var(--sem-7-card-6); }

        .sem-8 .subject-card:nth-child(1) { background-color: var(--sem-8-card-1); }
        .sem-8 .subject-card:nth-child(2) { background-color: var(--sem-8-card-2); }
        .sem-8 .subject-card:nth-child(3) { background-color: var(--sem-8-card-3); }
        .sem-8 .subject-card:nth-child(4) { background-color: var(--sem-8-card-4); }
        .sem-8 .subject-card:nth-child(5) { background-color: var(--sem-8-card-5); }
        .sem-8 .subject-card:nth-child(6) { background-color: var(--sem-8-card-6); }

        .sem-9 .subject-card:nth-child(1) { background-color: var(--sem-9-card-1); }
        .sem-9 .subject-card:nth-child(2) { background-color: var(--sem-9-card-2); }
        .sem-9 .subject-card:nth-child(3) { background-color: var(--sem-9-card-3); }
        .sem-9 .subject-card:nth-child(4) { background-color: var(--sem-9-card-4); }
        .sem-9 .subject-card:nth-child(5) { background-color: var(--sem-9-card-5); }
        .sem-9 .subject-card:nth-child(6) { background-color: var(--sem-9-card-6); }


        /* M√≥dulos */
        .module-type {
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
            flex: 1;
            min-width: 300px;
            max-width: 100%;
            box-sizing: border-box;
            background-color: var(--module-bg-neutral);
            transition: all 0.3s ease;
        }

        .module-type h3 {
            font-size: 1.6em;
            margin-top: 0;
            margin-bottom: 25px;
            color: #0056b3;
        }

        .module-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .module-category {
            background-color: #fff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
            flex: 1 1 calc(50% - 20px); /* 2 columnas para m√≥dulos */
            box-sizing: border-box;
            min-width: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.2s ease;
        }

        .module-category:hover {
            transform: translateY(-5px);
        }

        .module-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 15px;
            padding: 8px 15px;
            border-radius: 8px;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            width: 100%;
            box-sizing: border-box;
        }

        .module-ing .module-title { background-color: var(--module-ing-title); }
        .module-comp .module-title { background-color: var(--module-comp-title); }

        .module-card {
            background-color: #f9f9f9;
            border-radius: 10px;
            padding: 12px 15px;
            margin-bottom: 10px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            box-sizing: border-box;
            position: relative;
        }

        .module-card.approved {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1);
        }

        .module-card.blocked {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .module-ing .module-card:nth-child(1) { background-color: var(--module-ing-card-1); }
        .module-ing .module-card:nth-child(2) { background-color: var(--module-ing-card-2); }
        .module-ing .module-card:nth-child(3) { background-color: var(--module-ing-card-3); }
        .module-ing .module-card:nth-child(4) { background-color: var(--module-ing-card-4); }
        .module-ing .module-card:nth-child(5) { background-color: var(--module-ing-card-5); }
        .module-ing .module-card:nth-child(6) { background-color: var(--module-ing-card-6); }
        .module-ing .module-card:nth-child(7) { background-color: var(--module-ing-card-7); }

        .module-comp .module-card:nth-child(1) { background-color: var(--module-comp-card-1); }
        .module-comp .module-card:nth-child(2) { background-color: var(--module-comp-card-2); }
        .module-comp .module-card:nth-child(3) { background-color: var(--module-comp-card-3); }

        /* Bot√≥n de borrar progreso */
        .reset-button-container {
            text-align: center;
            margin-top: 40px;
        }

        .reset-button {
            background-color: #dc3545;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 500;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .reset-button:hover {
            background-color: #c82333;
            transform: translateY(-2px);
        }

        /* Mensaje de felicitaci√≥n (modal) */
        .completion-modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.6); /* Black w/ opacity */
            justify-content: center;
            align-items: center;
        }

        .completion-modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            text-align: center;
            position: relative;
            max-width: 500px;
            animation: fadeInScale 0.3s ease-out;
        }

        .completion-modal-content h2 {
            color: #28a745;
            font-size: 2.2em;
            margin-bottom: 20px;
        }

        .completion-modal-content p {
            font-size: 1.3em;
            color: #555;
            margin-bottom: 30px;
        }

        .completion-modal-content .close-button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }

        .completion-modal-content .close-button:hover {
            background-color: #0056b3;
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .semester {
                flex: 1 1 calc(50% - 20px); /* 2 columnas en tablet */
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 2em;
            }
            .stat-card {
                flex: 1 1 100%; /* 1 columna en mobile */
                max-width: none;
            }
            .unit {
                padding: 20px;
            }
            .semester {
                flex: 1 1 100%; /* 1 columna en mobile */
            }
            .module-category {
                flex: 1 1 100%; /* 1 columna para m√≥dulos en mobile */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LICENCIATURA EN TURISMO EN L√çNEA</h1>
            <div class="stats-section">
                <div class="stat-card">
                    <h4>Total Asignaturas</h4>
                    <p id="total-subjects">57</p>
                </div>
                <div class="stat-card">
                    <h4>Total M√≥dulos</h4>
                    <p id="total-modules">9</p>
                </div>
                <div class="stat-card">
                    <h4>Materias Aprobadas</h4>
                    <p id="approved-subjects-count">0</p>
                </div>
                <div class="stat-card">
                    <h4>Cr√©ditos Malla</h4>
                    <p id="credits-malla">0.00</p>
                </div>
                <div class="stat-card">
                    <h4>Cr√©ditos M√≥dulos Complementarios</h4>
                    <p id="credits-modules">0.00</p>
                </div>
                <div class="stat-card">
                    <h4>Cr√©ditos Totales</h4>
                    <p id="total-credits">0.00</p>
                </div>
            </div>
        </header>

        <main>
            <h2>Malla Curricular</h2>
            <div class="units-container" id="units-container">
                <!-- Las unidades y semestres se renderizar√°n aqu√≠ por JavaScript -->
            </div>

            <h2>M√≥dulos Complementarios</h2>
            <div class="modules-container" id="modules-container">
                <!-- Los m√≥dulos se renderizar√°n aqu√≠ por JavaScript -->
            </div>

            <div class="reset-button-container">
                <button id="reset-progress-button" class="reset-button">Borrar Progreso</button>
            </div>
        </main>
    </div>

    <!-- Modal de felicitaci√≥n -->
    <div id="completion-modal" class="completion-modal">
        <div class="completion-modal-content">
            <h2>üéìüéä ¬°Felicidades! üéäüéì</h2>
            <p>Has completado tu Carrera de Licenciatura en Turismo en L√≠nea.</p>
            <button id="close-completion-modal" class="close-button">Cerrar</button>
        </div>
    </div>

    <script>
        // Datos de la malla curricular y m√≥dulos
        const curriculumData = {
            units: [
                {
                    name: "UNIDAD PREUNIVERSITARIA",
                    class: "unit-preuniversitaria",
                    semesters: [
                        {
                            name: "PRE",
                            class: "sem-pre",
                            subjects: [
                                { name: "Epistemolog√≠a del Turismo", credits: 0, icon: "üß†", prerequisites: [] },
                                { name: "Introducci√≥n a la Comunicaci√≥n Acad√©mica", credits: 0, icon: "‚úçÔ∏è", prerequisites: [] },
                                { name: "Pensamiento Computacional", credits: 0, icon: "üíª", prerequisites: [] }
                            ]
                        }
                    ]
                },
                {
                    name: "UNIDAD B√ÅSICA",
                    class: "unit-basica",
                    semesters: [
                        {
                            name: "1ER SEMESTRE",
                            class: "sem-1",
                            subjects: [
                                { name: "Matem√°tica Financiera", credits: 1.6666, icon: "üí∞", prerequisites: ["Pensamiento Computacional"] },
                                { name: "Tecnolog√≠a Aplicada", credits: 3.33, icon: "üõ†Ô∏è", prerequisites: ["Pensamiento Computacional"] },
                                { name: "Teor√≠a Del Turismo", credits: 3.33, icon: "üìö", prerequisites: ["Epistemolog√≠a del Turismo"] },
                                { name: "Administraci√≥n", credits: 3.33, icon: "üìã", prerequisites: ["Introducci√≥n a la Comunicaci√≥n Acad√©mica"] },
                                { name: "Metodolog√≠a De La Investigaci√≥n Cient√≠fica", credits: 1.67, icon: "üî¨", prerequisites: ["Introducci√≥n a la Comunicaci√≥n Acad√©mica"] },
                                { name: "T√©cnicas De Operaci√≥n Tur√≠stica", credits: 3.33, icon: "üß≥", prerequisites: ["Epistemolog√≠a del Turismo"] }
                            ]
                        },
                        {
                            name: "2DO SEMESTRE",
                            class: "sem-2",
                            subjects: [
                                { name: "Cosmos Hist√≥rico", credits: 3.33, icon: "üè∫", prerequisites: ["Teor√≠a Del Turismo"] },
                                { name: "Bioentorno Tur√≠stico", credits: 3.33, icon: "üå±", prerequisites: ["Teor√≠a Del Turismo"] },
                                { name: "T√©cnicas De Guiar", credits: 3.33, icon: "üé§", prerequisites: ["T√©cnicas De Operaci√≥n Tur√≠stica"] },
                                { name: "Hospitalidad", credits: 3.33, icon: "ü§ù", prerequisites: ["Administraci√≥n"] },
                                { name: "Estad√≠stica Descriptiva Administrativa", credits: 1.6666, icon: "üìä", prerequisites: ["Matem√°tica Financiera", "Tecnolog√≠a Aplicada"] },
                                { name: "Comunicaci√≥n Oral Y Escrita", credits: 1.67, icon: "üó£Ô∏è", prerequisites: ["Metodolog√≠a De La Investigaci√≥n Cient√≠fica"] }
                            ]
                        },
                        {
                            name: "3ER SEMESTRE",
                            class: "sem-3",
                            subjects: [
                                { name: "Comunidad Y Turismo", credits: 1.6666, icon: "üèòÔ∏è", prerequisites: ["Hospitalidad"] },
                                { name: "Gastronom√≠a Ancestral Y Patrimonio", credits: 3.33, icon: "üç≤", prerequisites: ["Hospitalidad"] },
                                { name: "Gesti√≥n Operativa De √Åreas Protegidas", credits: 3.33, icon: "üèûÔ∏è", prerequisites: ["T√©cnicas De Guiar"] },
                                { name: "Manifestaciones Pl√°sticas Tur√≠sticas", credits: 3.33, icon: "üé®", prerequisites: ["Cosmos Hist√≥rico", "Comunicaci√≥n Oral Y Escrita"] },
                                { name: "Prospecci√≥n Intercultural Ecuatoriana", credits: 1.6666, icon: "üåé", prerequisites: ["Cosmos Hist√≥rico"] },
                                { name: "Contabilidad General", credits: 3.33, icon: "üìí", prerequisites: ["Estad√≠stica Descriptiva Administrativa"] }
                            ]
                        }
                    ]
                },
                {
                    name: "UNIDAD PROFESIONAL",
                    class: "unit-profesional",
                    semesters: [
                        {
                            name: "4TO SEMESTRE",
                            class: "sem-4",
                            subjects: [
                                { name: "Finanzas De Corto Plazo", credits: 3.33, icon: "üìà", prerequisites: ["Contabilidad General"] },
                                { name: "Gesti√≥n Territorial En Turismo", credits: 3.33, icon: "üåç", prerequisites: ["Gesti√≥n Operativa De √Åreas Protegidas", "Manifestaciones Pl√°sticas Tur√≠sticas"] },
                                { name: "Gesti√≥n Del Talento Humano Por Competencias", credits: 2.5, icon: "üë•", prerequisites: ["Contabilidad General"] },
                                { name: "Folklore", credits: 1.6666, icon: "üé≠", prerequisites: ["Manifestaciones Pl√°sticas Tur√≠sticas", "Prospecci√≥n Intercultural Ecuatoriana"] },
                                { name: "Codificaci√≥n Tur√≠stica", credits: 3.33, icon: "üß©", prerequisites: ["Gesti√≥n Operativa De √Åreas Protegidas"] },
                                { name: "Campismo Y Recreaci√≥n Tur√≠stica", credits: 1.6666, icon: "‚õ∫", prerequisites: ["Gastronom√≠a Ancestral Y Patrimonio", "Comunidad Y Turismo"] }
                            ]
                        },
                        {
                            name: "5TO SEMESTRE",
                            class: "sem-5",
                            subjects: [
                                { name: "Arqueolog√≠a", credits: 1.6666, icon: "üóø", prerequisites: ["Folklore"] },
                                { name: "Microeconom√≠a", credits: 3.33, icon: "üè¶", prerequisites: ["Finanzas De Corto Plazo"] },
                                { name: "Iconograf√≠a Tur√≠stica", credits: 1.6666, icon: "üñºÔ∏è", prerequisites: ["Campismo Y Recreaci√≥n Tur√≠stica"] },
                                { name: "Operaci√≥n De Tours", credits: 3.33, icon: "üöç", prerequisites: ["Codificaci√≥n Tur√≠stica", "Gesti√≥n Territorial En Turismo"] },
                                { name: "Fomento Y Regulaciones A La Actividad Tur√≠stica", credits: 3.33, icon: "‚öñÔ∏è", prerequisites: ["Gesti√≥n Del Talento Humano Por Competencias"] },
                                {
                                    name: "Desarrollo Del Turismo Sostenible", credits: 5, icon: "‚ôªÔ∏è",
                                    prerequisites: [
                                        "Matem√°tica Financiera", "Tecnolog√≠a Aplicada", "Teor√≠a Del Turismo", "Administraci√≥n",
                                        "Metodolog√≠a De La Investigaci√≥n Cient√≠fica", "T√©cnicas De Operaci√≥n Tur√≠stica",
                                        "Cosmos Hist√≥rico", "Bioentorno Tur√≠stico", "T√©cnicas De Guiar", "Hospitalidad",
                                        "Estad√≠stica Descriptiva Administrativa", "Comunicaci√≥n Oral Y Escrita",
                                        "Comunidad Y Turismo", "Gastronom√≠a Ancestral Y Patrimonio", "Gesti√≥n Operativa De √Åreas Protegidas",
                                        "Manifestaciones Pl√°sticas Tur√≠sticas", "Prospecci√≥n Intercultural Ecuatoriana",
                                        "Contabilidad General", "Finanzas De Corto Plazo", "Gesti√≥n Territorial En Turismo",
                                        "Gesti√≥n Del Talento Humano Por Competencias", "Folklore", "Codificaci√≥n Tur√≠stica",
                                        "Campismo Y Recreaci√≥n Tur√≠stica"
                                    ]
                                }
                            ]
                        },
                        {
                            name: "6TO SEMESTRE",
                            class: "sem-6",
                            subjects: [
                                {
                                    name: "Planificaci√≥n Tur√≠stica", credits: 5, icon: "üóìÔ∏è",
                                    prerequisites: [
                                        "Matem√°tica Financiera", "Tecnolog√≠a Aplicada", "Teor√≠a Del Turismo", "Administraci√≥n",
                                        "Metodolog√≠a De La Investigaci√≥n Cient√≠fica", "T√©cnicas De Operaci√≥n Tur√≠stica",
                                        "Cosmos Hist√≥rico", "Bioentorno Tur√≠stico", "T√©cnicas De Guiar", "Hospitalidad",
                                        "Estad√≠stica Descriptiva Administrativa", "Comunicaci√≥n Oral Y Escrita",
                                        "Comunidad Y Turismo", "Gastronom√≠a Ancestral Y Patrimonio", "Gesti√≥n Operativa De √Åreas Protegidas",
                                        "Manifestaciones Pl√°sticas Tur√≠sticas", "Prospecci√≥n Intercultural Ecuatoriana",
                                        "Contabilidad General", "Finanzas De Corto Plazo", "Gesti√≥n Territorial En Turismo",
                                        "Gesti√≥n Del Talento Humano Por Competencias", "Folklore", "Codificaci√≥n Tur√≠stica",
                                        "Campismo Y Recreaci√≥n Tur√≠stica", "Arqueolog√≠a", "Microeconom√≠a", "Iconograf√≠a Tur√≠stica",
                                        "Operaci√≥n De Tours", "Fomento Y Regulaciones A La Actividad Tur√≠stica", "Desarrollo Del Turismo Sostenible"
                                    ]
                                },
                                { name: "Gesti√≥n De La Innovaci√≥n Y Emprendimiento", credits: 3.33, icon: "üöÄ", prerequisites: ["Fomento Y Regulaciones A La Actividad Tur√≠stica"] },
                                { name: "Animaci√≥n Tur√≠stica", credits: 3.33, icon: "üé¨", prerequisites: ["Iconograf√≠a Tur√≠stica"] },
                                { name: "Rice - Organizaci√≥n De Eventos", credits: 1.6666, icon: "üìÖ", prerequisites: ["Desarrollo Del Turismo Sostenible"] },
                                { name: "Sistemas De Registros Tur√≠sticos / Sabre Y Amadeus", credits: 1.6666, icon: "üßæ", prerequisites: ["Operaci√≥n De Tours"] },
                                { name: "Macroeconom√≠a", credits: 3.33, icon: "üåê", prerequisites: ["Microeconom√≠a"] }
                            ]
                        },
                        {
                            name: "7MO SEMESTRE",
                            class: "sem-7",
                            subjects: [
                                {
                                    name: "Patrimonio", credits: 5, icon: "üèõÔ∏è",
                                    prerequisites: [
                                        "Planificaci√≥n Tur√≠stica", "Gesti√≥n De La Innovaci√≥n Y Emprendimiento",
                                        "Animaci√≥n Tur√≠stica", "Rice - Organizaci√≥n De Eventos",
                                        "Sistemas De Registros Tur√≠sticos / Sabre Y Amadeus", "Macroeconom√≠a"
                                    ]
                                },
                                { name: "Gesti√≥n De Calidad Y La Productividad", credits: 3.33, icon: "‚úÖ", prerequisites: ["Gesti√≥n De La Innovaci√≥n Y Emprendimiento"] },
                                { name: "Operaci√≥n De Alimentos Y Bebidas", credits: 1.6666, icon: "üçΩÔ∏è", prerequisites: ["Animaci√≥n Tur√≠stica"] },
                                { name: "Operaci√≥n Hotelera", credits: 3.33, icon: "üè®", prerequisites: ["Sistemas De Registros Tur√≠sticos / Sabre Y Amadeus"] },
                                { name: "Sociolog√≠a Del Turismo", credits: 3.33, icon: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", prerequisites: ["Animaci√≥n Tur√≠stica"] },
                                { name: "Tendencias Tur√≠sticas", credits: 1.6666, icon: "üìà", prerequisites: ["Macroeconom√≠a"] }
                            ]
                        }
                    ]
                },
                {
                    name: "UNIDAD DE TITULACI√ìN",
                    class: "unit-titulacion",
                    semesters: [
                        {
                            name: "8VO SEMESTRE",
                            class: "sem-8",
                            subjects: [
                                { name: "Formulaci√≥n Y Evaluaci√≥n De Proyectos", credits: 3.33, icon: "üìê", prerequisites: ["Gesti√≥n De Calidad Y La Productividad"] },
                                {
                                    name: "Integraci√≥n Regional Tur√≠stica", credits: 5, icon: "ü§ù",
                                    prerequisites: [
                                        "Patrimonio", "Gesti√≥n De Calidad Y La Productividad",
                                        "Operaci√≥n De Alimentos Y Bebidas", "Operaci√≥n Hotelera",
                                        "Sociolog√≠a Del Turismo", "Tendencias Tur√≠sticas"
                                    ]
                                },
                                { name: "Estrategias Comerciales Tur√≠sticas", credits: 3.33, icon: "üéØ", prerequisites: ["Tendencias Tur√≠sticas"] },
                                {
                                    name: "Redacci√≥n Del Trabajo De Titulaci√≥n", credits: 1.6666, icon: "üìñ",
                                    prerequisites: [
                                        "Patrimonio", "Gesti√≥n De Calidad Y La Productividad",
                                        "Operaci√≥n De Alimentos Y Bebidas", "Operaci√≥n Hotelera",
                                        "Sociolog√≠a Del Turismo", "Tendencias Tur√≠sticas"
                                    ]
                                },
                                { name: "Apreciaci√≥n Del Arte Y La Cultura", credits: 1.6666, icon: "üñåÔ∏è", prerequisites: ["Patrimonio"] },
                                { name: "Turismo Y Gobernanza", credits: 3.33, icon: "üèõÔ∏è", prerequisites: ["Operaci√≥n De Alimentos Y Bebidas", "Sociolog√≠a Del Turismo"] }
                            ]
                        },
                        {
                            name: "9NO SEMESTRE",
                            class: "sem-9",
                            subjects: [
                                {
                                    name: "Gesti√≥n Integral De Destinos Tur√≠sticos", credits: 5, icon: "üåü",
                                    prerequisites: [
                                        "Formulaci√≥n Y Evaluaci√≥n De Proyectos", "Integraci√≥n Regional Tur√≠stica",
                                        "Estrategias Comerciales Tur√≠sticas", "Redacci√≥n Del Trabajo De Titulaci√≥n",
                                        "Apreciaci√≥n Del Arte Y La Cultura", "Turismo Y Gobernanza"
                                    ]
                                },
                                { name: "T√©cnicas De Negociaci√≥n Y Comunicaci√≥n Para El Turismo", credits: 3.3333, icon: "ü§ùüó£Ô∏è", prerequisites: ["Estrategias Comerciales Tur√≠sticas"] },
                                { name: "Realidad Nacional Y Geopol√≠tica", credits: 1.67, icon: "üåè", prerequisites: ["Turismo Y Gobernanza"] },
                                { name: "Trabajo De Titulaci√≥n", credits: 3.33, icon: "üéì", prerequisites: ["Redacci√≥n Del Trabajo De Titulaci√≥n"] },
                                { name: "Contrataci√≥n P√∫blica", credits: 3.33, icon: "üìù", prerequisites: ["Formulaci√≥n Y Evaluaci√≥n De Proyectos"] },
                                { name: "Liderazgo", credits: 1.6666, icon: "üëë", prerequisites: ["Apreciaci√≥n Del Arte Y La Cultura"] }
                            ]
                        }
                    ]
                }
            ],
            modules: [
                {
                    type: "Ingl√©s",
                    class: "module-ing",
                    icon: "üìò",
                    levels: [
                        { name: "Nivel -A1", credits: 2.08, icon: "üî¥üèÜ", prerequisites: [] },
                        { name: "Nivel A1", credits: 2.08, icon: "üü†üèÜ", prerequisites: ["Nivel -A1"] },
                        { name: "Nivel A2", credits: 2.08, icon: "üü°üèÜ", prerequisites: ["Nivel A1"] },
                        { name: "Nivel B1", credits: 2.08, icon: "üü¢üèÜ", prerequisites: ["Nivel A2"] },
                        { name: "Nivel B2", credits: 2.08, icon: "üîµüèÜ", prerequisites: ["Nivel B1"] },
                        { name: "Nivel C1", credits: 2.08, icon: "üü£üèÜ", prerequisites: ["Nivel B2"] },
                        { name: "Nivel C2", credits: 2.08, icon: "üü§üèÜ", prerequisites: ["Nivel C1"] }
                    ]
                },
                {
                    type: "Computaci√≥n",
                    class: "module-comp",
                    icon: "üíª",
                    levels: [
                        { name: "Nivel 1: Windows - Word - Internet", credits: 8, icon: "ü™üüìÑüåê", prerequisites: [] },
                        { name: "Nivel 2: Excel ‚Äì Power Point", credits: 8, icon: "üìäüìΩÔ∏è", prerequisites: ["Nivel 1: Windows - Word - Internet"] }
                    ]
                }
            ]
        };

        // Estado global
        let approvedSubjects = new Set();
        let approvedModules = new Set();

        // Funci√≥n para guardar el progreso en localStorage
        function saveProgress() {
            localStorage.setItem('approvedSubjects', JSON.stringify(Array.from(approvedSubjects)));
            localStorage.setItem('approvedModules', JSON.stringify(Array.from(approvedModules)));
        }

        // Funci√≥n para cargar el progreso de localStorage
        function loadProgress() {
            const savedSubjects = localStorage.getItem('approvedSubjects');
            const savedModules = localStorage.getItem('approvedModules');
            if (savedSubjects) {
                approvedSubjects = new Set(JSON.parse(savedSubjects));
            }
            if (savedModules) {
                approvedModules = new Set(JSON.parse(savedModules));
            }
        }

        // Funci√≥n para verificar si una materia est√° aprobada
        function isSubjectApproved(subjectName) {
            return approvedSubjects.has(subjectName);
        }

        // Funci√≥n para verificar si un m√≥dulo est√° aprobado
        function isModuleApproved(moduleName) {
            return approvedModules.has(moduleName);
        }

        // Funci√≥n para verificar los prerrequisitos de una materia/m√≥dulo
        function checkPrerequisites(item, isModule = false) {
            if (!item.prerequisites || item.prerequisites.length === 0) {
                return { blocked: false, missing: [] };
            }

            const missingPrerequisites = item.prerequisites.filter(prereq => {
                // Check if the prerequisite is a module or a subject
                const isPrereqModule = curriculumData.modules.some(modType => modType.levels.some(level => level.name === prereq));
                if (isPrereqModule) {
                    return !isModuleApproved(prereq);
                } else {
                    return !isSubjectApproved(prereq);
                }
            });

            return {
                blocked: missingPrerequisites.length > 0,
                missing: missingPrerequisites
            };
        }

        // Funci√≥n para actualizar las estad√≠sticas
        function updateStats() {
            let totalApprovedSubjects = 0;
            let totalCreditsMalla = 0;
            let totalCreditsModules = 0;

            curriculumData.units.forEach(unit => {
                unit.semesters.forEach(semester => {
                    semester.subjects.forEach(subject => {
                        if (isSubjectApproved(subject.name)) {
                            totalApprovedSubjects++;
                            totalCreditsMalla += subject.credits;
                        }
                    });
                });
            });

            curriculumData.modules.forEach(moduleType => {
                moduleType.levels.forEach(module => {
                    if (isModuleApproved(module.name)) {
                        totalApprovedSubjects++; // M√≥dulos tambi√©n cuentan como "materias aprobadas" para el total
                        totalCreditsModules += module.credits;
                    }
                });
            });

            const totalCredits = totalCreditsMalla + totalCreditsModules;

            document.getElementById('approved-subjects-count').textContent = totalApprovedSubjects;
            document.getElementById('credits-malla').textContent = totalCreditsMalla.toFixed(2);
            document.getElementById('credits-modules').textContent = totalCreditsModules.toFixed(2);
            document.getElementById('total-credits').textContent = totalCredits.toFixed(2);
        }

        // Funci√≥n para renderizar la malla curricular
        function renderCurriculum() {
            const unitsContainer = document.getElementById('units-container');
            unitsContainer.innerHTML = ''; // Limpiar antes de renderizar

            curriculumData.units.forEach(unit => {
                const unitDiv = document.createElement('div');
                unitDiv.className = `unit ${unit.class}`;
                unitDiv.innerHTML = `<h3>${unit.name}</h3><div class="semesters-grid"></div>`;
                const semestersGrid = unitDiv.querySelector('.semesters-grid');

                unit.semesters.forEach(semester => {
                    const semesterDiv = document.createElement('div');
                    semesterDiv.className = `semester ${semester.class}`;
                    semesterDiv.innerHTML = `<div class="semester-title">${semester.name}</div>`;

                    semester.subjects.forEach((subject, index) => {
                        const subjectCard = document.createElement('div');
                        subjectCard.className = 'subject-card';
                        subjectCard.dataset.name = subject.name;

                        const { blocked, missing } = checkPrerequisites(subject);
                        if (isSubjectApproved(subject.name)) {
                            subjectCard.classList.add('approved');
                        } else if (blocked) {
                            subjectCard.classList.add('blocked');
                            const tooltip = document.createElement('span');
                            tooltip.className = 'tooltip';
                            tooltip.textContent = `Faltan: ${missing.join(', ')}`;
                            subjectCard.appendChild(tooltip);
                        }

                        subjectCard.innerHTML += `
                            <span class="icon">${subject.icon}</span>
                            <div class="subject-info">
                                <strong>${subject.name}</strong>
                                <small>Cr√©ditos: ${subject.credits}</small>
                            </div>
                        `;
                        semesterDiv.appendChild(subjectCard);
                    });
                    semestersGrid.appendChild(semesterDiv);
                });
                unitsContainer.appendChild(unitDiv);
            });
        }

        // Funci√≥n para renderizar los m√≥dulos
        function renderModules() {
            const modulesContainer = document.getElementById('modules-container');
            modulesContainer.innerHTML = ''; // Limpiar antes de renderizar

            curriculumData.modules.forEach(moduleType => {
                const moduleTypeDiv = document.createElement('div');
                moduleTypeDiv.className = `module-type ${moduleType.class}`;
                moduleTypeDiv.innerHTML = `<h3>${moduleType.icon} M√ìDULO: ${moduleType.type}</h3><div class="module-grid"></div>`;
                const moduleGrid = moduleTypeDiv.querySelector('.module-grid');

                const moduleCategoryDiv = document.createElement('div');
                moduleCategoryDiv.className = `module-category ${moduleType.class}`;
                moduleCategoryDiv.innerHTML = `<div class="module-title">${moduleType.type}</div>`;

                moduleType.levels.forEach(module => {
                    const moduleCard = document.createElement('div');
                    moduleCard.className = 'module-card';
                    moduleCard.dataset.name = module.name;

                    const { blocked, missing } = checkPrerequisites(module, true);
                    if (isModuleApproved(module.name)) {
                        moduleCard.classList.add('approved');
                    } else if (blocked) {
                        moduleCard.classList.add('blocked');
                        const tooltip = document.createElement('span');
                        tooltip.className = 'tooltip';
                        tooltip.textContent = `Faltan: ${missing.join(', ')}`;
                        moduleCard.appendChild(tooltip);
                    }

                    moduleCard.innerHTML += `
                        <span class="icon">${module.icon}</span>
                        <div class="subject-info">
                            <strong>${module.name}</strong>
                            <small>Cr√©ditos: ${module.credits}</small>
                        </div>
                    `;
                    moduleCategoryDiv.appendChild(moduleCard);
                });
                moduleGrid.appendChild(moduleCategoryDiv);
                modulesContainer.appendChild(moduleTypeDiv);
            });
        }

        // Funci√≥n principal para actualizar la UI
        function updateUI() {
            renderCurriculum();
            renderModules();
            updateStats();
            checkCompletion();
        }

        // Manejador de clic para materias
        document.addEventListener('click', (event) => {
            if (event.target.closest('.subject-card')) {
                const subjectCard = event.target.closest('.subject-card');
                const subjectName = subjectCard.dataset.name;

                // Encontrar la materia en los datos
                let subject = null;
                for (const unit of curriculumData.units) {
                    for (const semester of unit.semesters) {
                        subject = semester.subjects.find(s => s.name === subjectName);
                        if (subject) break;
                    }
                    if (subject) break;
                }

                if (!subject) return; // No se encontr√≥ la materia

                const { blocked } = checkPrerequisites(subject);

                if (subjectCard.classList.contains('approved')) {
                    // Desaprobar materia
                    approvedSubjects.delete(subjectName);
                    // Desaprobar recursivamente materias que dependen de esta
                    const subjectsToUnapprove = [subjectName];
                    let i = 0;
                    while (i < subjectsToUnapprove.length) {
                        const currentSubject = subjectsToUnapprove[i];
                        curriculumData.units.forEach(unit => {
                            unit.semesters.forEach(semester => {
                                semester.subjects.forEach(s => {
                                    if (s.prerequisites && s.prerequisites.includes(currentSubject) && approvedSubjects.has(s.name) && !subjectsToUnapprove.includes(s.name)) {
                                        approvedSubjects.delete(s.name);
                                        subjectsToUnapprove.push(s.name);
                                    }
                                });
                            });
                        });
                        i++;
                    }
                } else if (!blocked) {
                    // Aprobar materia si no est√° bloqueada
                    approvedSubjects.add(subjectName);
                } else {
                    // Si est√° bloqueada, no hacer nada (el tooltip ya muestra la raz√≥n)
                    return;
                }
                saveProgress();
                updateUI();
            } else if (event.target.closest('.module-card')) {
                const moduleCard = event.target.closest('.module-card');
                const moduleName = moduleCard.dataset.name;

                // Encontrar el m√≥dulo en los datos
                let module = null;
                for (const moduleType of curriculumData.modules) {
                    module = moduleType.levels.find(m => m.name === moduleName);
                    if (module) break;
                }

                if (!module) return; // No se encontr√≥ el m√≥dulo

                const { blocked } = checkPrerequisites(module, true);

                if (moduleCard.classList.contains('approved')) {
                    // Desaprobar m√≥dulo
                    approvedModules.delete(moduleName);
                    // Desaprobar recursivamente m√≥dulos que dependen de este
                    const modulesToUnapprove = [moduleName];
                    let i = 0;
                    while (i < modulesToUnapprove.length) {
                        const currentModule = modulesToUnapprove[i];
                        curriculumData.modules.forEach(moduleType => {
                            moduleType.levels.forEach(m => {
                                if (m.prerequisites && m.prerequisites.includes(currentModule) && approvedModules.has(m.name) && !modulesToUnapprove.includes(m.name)) {
                                    approvedModules.delete(m.name);
                                    modulesToUnapprove.push(m.name);
                                }
                            });
                        });
                        i++;
                    }
                } else if (!blocked) {
                    // Aprobar m√≥dulo si no est√° bloqueado
                    approvedModules.add(moduleName);
                } else {
                    return;
                }
                saveProgress();
                updateUI();
            }
        });

        // Borrar progreso
        document.getElementById('reset-progress-button').addEventListener('click', () => {
            if (confirm('¬øEst√°s seguro de que quieres borrar todo el progreso? Esta acci√≥n es irreversible.')) {
                localStorage.clear();
                approvedSubjects.clear();
                approvedModules.clear();
                updateUI();
            }
        });

        // Comprobar si la carrera est√° completa
        function checkCompletion() {
            const totalSubjectsInMalla = curriculumData.units.reduce((count, unit) =>
                count + unit.semesters.reduce((semCount, sem) => semCount + sem.subjects.length, 0), 0
            );
            const totalModulesCount = curriculumData.modules.reduce((count, modType) =>
                count + modType.levels.length, 0
            );

            const allMallaSubjectsApproved = approvedSubjects.size === totalSubjectsInMalla;
            const allModulesApproved = approvedModules.size === totalModulesCount;

            const completionModal = document.getElementById('completion-modal');
            if (allMallaSubjectsApproved && allModulesApproved) {
                completionModal.style.display = 'flex';
            } else {
                completionModal.style.display = 'none';
            }
        }

        // Cerrar modal de felicitaci√≥n
        document.getElementById('close-completion-modal').addEventListener('click', () => {
            document.getElementById('completion-modal').style.display = 'none';
        });

        // Inicializar la aplicaci√≥n al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
            updateUI();
        });
    </script>
</body>
</html>
